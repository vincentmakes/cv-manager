<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Manager</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/shared/styles.css">
    <link rel="stylesheet" href="/shared/admin.css">
</head>
<body>
    <!-- Toolbar -->
    <div class="toolbar no-print">
        <div class="toolbar-title">CV Manager</div>
        <div class="toolbar-actions" id="toolbarActions">
            <button class="btn btn-secondary" onclick="openSettingsModal()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                <span data-i18n="toolbar.settings">Settings</span>
            </button>
            <div class="color-picker-wrapper">
                <button class="btn btn-secondary" onclick="toggleColorPicker()" data-i18n-title="toolbar.change_theme" title="Change Theme Color">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/></svg>
                    <span data-i18n="toolbar.theme">Theme</span>
                </button>
                <div class="color-picker-dropdown" id="colorPickerDropdown">
                    <div class="color-picker-header" data-i18n="theme.title">Theme Color</div>
                    <div class="color-wheel-container">
                        <canvas id="colorWheel" width="180" height="180"></canvas>
                        <div class="color-wheel-cursor" id="colorWheelCursor"></div>
                    </div>
                    <div class="color-brightness">
                        <label data-i18n="theme.brightness">Brightness</label>
                        <input type="range" id="colorBrightness" min="30" max="70" value="50">
                    </div>
                    <div class="color-preview-row">
                        <div class="color-preview" id="colorPreview"></div>
                        <input type="text" class="color-hex-input" id="colorHexInput" value="#0066ff" maxlength="7">
                    </div>
                    <div class="color-presets">
                        <div class="color-preset" style="background: #0066ff" data-color="#0066ff" data-i18n-title="theme.blue" title="Blue (Default)"></div>
                        <div class="color-preset" style="background: #059669" data-color="#059669" data-i18n-title="theme.emerald" title="Emerald"></div>
                        <div class="color-preset" style="background: #7c3aed" data-color="#7c3aed" data-i18n-title="theme.purple" title="Purple"></div>
                        <div class="color-preset" style="background: #dc2626" data-color="#dc2626" data-i18n-title="theme.red" title="Red"></div>
                        <div class="color-preset" style="background: #ea580c" data-color="#ea580c" data-i18n-title="theme.orange" title="Orange"></div>
                        <div class="color-preset" style="background: #0891b2" data-color="#0891b2" data-i18n-title="theme.cyan" title="Cyan"></div>
                        <div class="color-preset" style="background: #4f46e5" data-color="#4f46e5" data-i18n-title="theme.indigo" title="Indigo"></div>
                        <div class="color-preset" style="background: #be185d" data-color="#be185d" data-i18n-title="theme.pink" title="Pink"></div>
                    </div>
                    <div class="color-picker-actions">
                        <button class="btn btn-ghost btn-sm" onclick="resetThemeColor()" data-i18n="theme.reset">Reset</button>
                        <button class="btn btn-primary btn-sm" onclick="applyThemeColor()" data-i18n="theme.apply">Apply</button>
                    </div>
                </div>
            </div>
            <button class="btn btn-secondary" onclick="openDatasetsModal()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/></svg>
                <span data-i18n="toolbar.open">Open...</span>
            </button>
            <button class="btn btn-secondary" onclick="saveAsDataset()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/></svg>
                <span data-i18n="toolbar.save_as">Save As...</span>
            </button>
            <button class="btn btn-secondary" onclick="showAllItems()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                <span data-i18n="toolbar.show_all">Show All</span>
            </button>
            <button class="btn btn-secondary" onclick="exportData()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
                <span data-i18n="toolbar.export">Export</span>
            </button>
            <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                <span data-i18n="toolbar.import">Import</span>
            </button>
            <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
            <a href="https://github.com/vincentmakes/cv-manager/blob/main/USER_GUIDE.md" target="_blank" rel="noopener noreferrer" class="btn btn-secondary" title="User Guide & FAQ">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><circle cx="12" cy="17" r="0.5" fill="currentColor"/></svg>
                <span data-i18n="toolbar.help">Help</span>
            </a>
            <button class="btn btn-primary toolbar-print-inline" onclick="window.print()">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
                <span data-i18n="toolbar.print">Print / PDF</span>
            </button>
        </div>
        <div class="toolbar-end">
            <button class="btn btn-primary toolbar-print-mobile" onclick="window.print()" title="Print / PDF">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
            </button>
            <button class="btn btn-secondary toolbar-hamburger" onclick="toggleMobileMenu(event)" title="Menu" id="toolbarHamburger">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
            </button>
        </div>
    </div>

    <!-- Update Banner (hidden by default) -->
    <div id="updateBanner" class="update-banner no-print" style="display: none;">
        <div class="update-banner-content">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            <span id="updateBannerText"></span>
            <a id="updateBannerLink" href="#" target="_blank" rel="noopener noreferrer" class="update-banner-link" data-i18n="banner.whats_new">What's new</a>
            <button class="update-banner-dismiss" onclick="dismissUpdateBanner()" data-i18n-title="banner.dismiss" title="Dismiss">&times;</button>
        </div>
    </div>

    <!-- Active Dataset Banner (hidden by default) -->
    <div id="activeDatasetBanner" class="active-dataset-banner no-print" style="display: none;">
        <div class="active-dataset-banner-content">
            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
            <span class="active-dataset-label" data-i18n="banner.editing">Editing:</span>
            <span id="activeDatasetName" class="active-dataset-name"></span>
            <span id="activeDatasetDefaultBadge" class="active-dataset-default-badge" style="display: none;" data-i18n="banner.default">Default</span>
            <div class="active-dataset-actions">
                <span id="activeDatasetStatus" class="active-dataset-status"></span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container" role="main">
        <!-- ATS-friendly hidden text version -->
        <div id="ats-content" class="ats-only" aria-hidden="true"></div>
        
        <!-- Header -->
        <header class="header" id="section-header" itemscope itemtype="https://schema.org/Person">
            <div class="section-actions no-print">
                <button class="icon-btn" onclick="editProfile()" data-i18n-title="action.edit_profile" title="Edit Profile">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                </button>
            </div>
            <div class="header-content">
                <div class="profile-image" id="profileImage">
                    <span id="profileInitials">CV</span>
                    <img id="profilePicture" src="/uploads/picture.jpeg" alt="" style="display:none;">
                </div>
                <div class="profile-info">
                    <h1 class="profile-name" id="profileName" itemprop="name">Loading...</h1>
                    <p class="profile-title" id="profileTitle" itemprop="jobTitle"></p>
                    <p class="profile-subtitle" id="profileSubtitle"></p>
                    <address class="contact-badges" id="contactBadges"></address>
                </div>
            </div>
        </header>

        <!-- About Section -->
        <section class="section" id="section-about">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.about">Professional Summary</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="openModal('profile')" data-i18n-title="action.edit_about" title="Edit About">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                    </button>
                    <button class="icon-btn" onclick="toggleSection('about')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-about">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <p class="about-text" id="aboutText" itemprop="description"></p>
        </section>

        <!-- Timeline Section -->
        <section class="section" id="section-timeline">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.timeline">Career Timeline</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="toggleSection('timeline')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-timeline">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <div class="timeline-container">
                <div class="timeline-track"></div>
                <div class="timeline-items" id="timelineItems"></div>
            </div>
        </section>

        <!-- Experience Section -->
        <section class="section" id="section-experience">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.experience">Work Experience</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="toggleSection('experience')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-experience">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <div class="items-list" id="experienceList"></div>
            <button class="add-btn no-print" onclick="openModal('experience')">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                <span data-i18n="action.add_experience">Add Experience</span>
            </button>
        </section>

        <!-- Certifications Section -->
        <section class="section" id="section-certifications">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.certifications">Certifications</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="toggleSection('certifications')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-certifications">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <div class="cert-grid" id="certGrid"></div>
            <button class="add-btn no-print" onclick="openModal('certification')">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                <span data-i18n="action.add_certification">Add Certification</span>
            </button>
        </section>

        <!-- Education Section -->
        <section class="section" id="section-education">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.education">Education</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="toggleSection('education')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-education">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <div class="items-list" id="educationList"></div>
            <button class="add-btn no-print" onclick="openModal('education')">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                <span data-i18n="action.add_education">Add Education</span>
            </button>
        </section>

        <!-- Skills Section -->
        <section class="section" id="section-skills">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.skills">Skills & Expertise</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="toggleSection('skills')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-skills">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <div class="skills-grid" id="skillsGrid"></div>
            <button class="add-btn no-print" onclick="openModal('skill')">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                <span data-i18n="action.add_skill">Add Skill Category</span>
            </button>
        </section>

        <!-- Projects Section -->
        <section class="section" id="section-projects">
            <div class="section-header">
                <h2 class="section-title" data-i18n="section.projects">Featured Projects</h2>
                <div class="section-actions no-print">
                    <button class="icon-btn" onclick="toggleSection('projects')" data-i18n-title="action.toggle_visibility" title="Toggle Visibility" id="toggle-projects">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                    </button>
                </div>
            </div>
            <div class="projects-grid" id="projectsGrid"></div>
            <button class="add-btn no-print" onclick="openModal('project')">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                <span data-i18n="action.add_project">Add Project</span>
            </button>
        </section>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Edit</h3>
                <button class="modal-close" onclick="closeModal()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer">
                <div class="modal-footer-left">
                    <button class="btn btn-danger" id="deleteBtn" onclick="deleteItem()" style="display:none" data-i18n="btn.delete">Delete</button>
                </div>
                <div class="modal-footer-right">
                    <button class="btn btn-ghost" onclick="closeModal()" data-i18n="btn.cancel">Cancel</button>
                    <button class="btn btn-primary" onclick="saveItem()" data-i18n="btn.save">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Datasets Modal -->
    <div class="modal-overlay" id="datasetsModalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" data-i18n="datasets.title">Saved Datasets</h3>
                <button class="modal-close" onclick="closeDatasetsModal()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="modal-body" id="datasetsModalBody">
                <div class="datasets-legend">
                    <div class="datasets-legend-item">
                        <span class="radio-dot radio-dot-preview"></span>
                        <span><strong>Radio button</strong> — select which dataset visitors see at your root URL <code>/</code></span>
                    </div>
                    <div class="datasets-legend-item">
                        <span class="toggle-preview"><span class="toggle-preview-knob"></span></span>
                        <span><strong>Toggle</strong> — share other datasets at their own <code>/v/slug</code> URL</span>
                    </div>
                    <div class="datasets-legend-item">
                        <svg class="legend-icon" width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                        <span><strong>Eye</strong> — preview a saved dataset without making it public</span>
                    </div>
                </div>
                <div id="datasetsList"></div>
            </div>
            <div class="modal-footer">
                <div class="modal-footer-left"></div>
                <div class="modal-footer-right">
                    <button class="btn btn-ghost" onclick="closeDatasetsModal()" data-i18n="btn.close">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay settings-modal" id="settingsModalOverlay">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h3 class="modal-title" data-i18n="settings.title">Settings</h3>
                <button class="modal-close" onclick="closeSettingsModal()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="settings-tab active" onclick="switchSettingsTab('sections')" data-tab="sections" data-i18n="settings.tab.sections">Sections & Headlines</button>
                    <button class="settings-tab" onclick="switchSettingsTab('custom')" data-tab="custom" data-i18n="settings.tab.custom">Custom Sections</button>
                    <button class="settings-tab" onclick="switchSettingsTab('public')" data-tab="public" data-i18n="settings.tab.print">Print & Export</button>
                    <button class="settings-tab" onclick="switchSettingsTab('advanced')" data-tab="advanced" data-i18n="settings.tab.advanced">Advanced</button>
                    <button class="settings-tab" onclick="switchSettingsTab('language')" data-tab="language" data-i18n="settings.tab.language">Language</button>
                </div>
                
                <!-- Sections & Headlines Tab -->
                <div class="settings-tab-content active" id="settingsTabSections">
                    <div class="settings-info" data-i18n="settings.sections.info">
                        Drag sections to reorder them, or use the arrow buttons. Toggle visibility with the eye icon. Click section names to edit headlines.
                    </div>
                    <div id="settingsSectionsList"></div>
                </div>
                
                <!-- Custom Sections Tab -->
                <div class="settings-tab-content" id="settingsTabCustom">
                    <div class="settings-info" data-i18n="settings.custom.info">
                        Create custom sections with different layouts. Custom sections appear in the section order list above.
                    </div>
                    <button class="add-btn" onclick="openCustomSectionModal()" style="margin-top: 0; margin-bottom: 16px;">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                        <span data-i18n="settings.custom.add">Add Custom Section</span>
                    </button>
                    <div id="customSectionsList"></div>
                </div>
                
                <!-- Print & Export Tab -->
                <div class="settings-tab-content" id="settingsTabPublic">
                    <!-- Print Button Setting -->
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.print.public_button">Public Print Button</div>
                            <div class="settings-option-desc" data-i18n="settings.print.public_button_desc">Show print button on public site</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="settingShowPrintButton" onchange="togglePublicSetting('showPublicPrintButton', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <!-- Page Numbers Setting - Compact -->
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.print.page_numbers">Page Numbers</div>
                            <div class="settings-option-desc" data-i18n="settings.print.page_numbers_desc">Show page numbers when printing</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="settingPaginationEnabled" onchange="togglePublicSetting('paginationEnabled', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <!-- Pagination Options Row (inline) -->
                    <div class="pagination-options-row" id="paginationOptionsRow" style="display: none;">
                        <div class="pagination-option-group">
                            <label class="pagination-option-label" data-i18n="settings.print.position">Position</label>
                            <select class="pagination-select" id="settingPaginationPosition" onchange="togglePublicSetting('paginationPosition', this.value)">
                                <option value="bottom-center" data-i18n="settings.print.bottom_center">Bottom Center</option>
                                <option value="bottom-right" data-i18n="settings.print.bottom_right">Bottom Right</option>
                                <option value="bottom-left" data-i18n="settings.print.bottom_left">Bottom Left</option>
                                <option value="top-center" data-i18n="settings.print.top_center">Top Center</option>
                                <option value="top-right" data-i18n="settings.print.top_right">Top Right</option>
                                <option value="top-left" data-i18n="settings.print.top_left">Top Left</option>
                            </select>
                        </div>
                        <div class="pagination-option-group">
                            <label class="pagination-option-label" data-i18n="settings.print.format">Format</label>
                            <select class="pagination-select" id="settingPaginationStyle" onchange="togglePublicSetting('paginationStyle', this.value)">
                                <option value="simple">1</option>
                                <option value="with-total">1 of 3</option>
                                <option value="with-name">Name | 1</option>
                                <option value="minimal">— 1 —</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Allow Section Splits Setting -->
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.print.section_splits">Allow Section Splits</div>
                            <div class="settings-option-desc" data-i18n="settings.print.section_splits_desc">Let sections break across pages (items stay intact)</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="settingAllowSectionSplits" onchange="toggleSplitSetting('allowSectionSplits', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <!-- Allow Item Splits Setting (sub-option) -->
                    <div class="settings-option settings-sub-option" id="itemSplitsOption" style="display: none;">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.print.item_splits">Allow Item Splits</div>
                            <div class="settings-option-desc" data-i18n="settings.print.item_splits_desc">Also let items break across pages for maximum compactness</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="settingAllowItemSplits" onchange="toggleSplitSetting('allowItemSplits', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <!-- Advanced Tab -->
                <div class="settings-tab-content" id="settingsTabAdvanced">
                    <div class="settings-info" data-i18n="settings.advanced.info">
                        Advanced settings for formatting, SEO, analytics and custom integrations.
                    </div>
                    
                    <!-- Date Format Setting -->
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.advanced.date_format">Date Format</div>
                            <div class="settings-option-desc" data-i18n="settings.advanced.date_format_desc">Choose how dates are displayed on your CV</div>
                        </div>
                        <select class="pagination-select" id="settingDateFormat" style="min-width: 140px;">
                            <option value="MMM YYYY">Jan 2020</option>
                            <option value="MMM YY">Jan 20</option>
                            <option value="MMMM YYYY">January 2020</option>
                            <option value="MM/YYYY">01/2020</option>
                            <option value="MM.YYYY">01.2020</option>
                            <option value="MM-YYYY">01-2020</option>
                            <option value="YYYY-MM">2020-01</option>
                            <option value="YYYY" data-i18n="settings.advanced.date_year_only">2020 (year only)</option>
                        </select>
                    </div>
                    
                    <!-- Timeline Year Only Setting -->
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.advanced.timeline_years">Timeline: Years Only</div>
                            <div class="settings-option-desc" data-i18n="settings.advanced.timeline_years_desc">Display only years (YYYY) in the timeline, regardless of date format</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="settingTimelineYearOnly">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <!-- Search Engine Indexing (Robots Meta) Setting -->
                    <div class="settings-option" style="align-items: flex-start;">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.advanced.seo_indexing">Search Engine Indexing</div>
                            <div class="settings-option-desc" data-i18n="settings.advanced.seo_indexing_desc">Control how search engines handle your public CV page</div>
                        </div>
                        <select class="pagination-select" id="settingRobotsMeta" style="min-width: 160px;">
                            <option value="index, follow" data-i18n="settings.advanced.index_follow">Index, Follow</option>
                            <option value="noindex, follow" data-i18n="settings.advanced.noindex_follow">No Index, Follow</option>
                            <option value="index, nofollow" data-i18n="settings.advanced.index_nofollow">Index, No Follow</option>
                            <option value="noindex, nofollow" data-i18n="settings.advanced.noindex_nofollow">No Index, No Follow</option>
                        </select>
                    </div>
                    <div class="settings-robots-hints">
                        <div class="settings-robots-hint"><strong>Index</strong> — <span data-i18n="settings.advanced.seo_hint_index">Search engines can list your CV in results</span></div>
                        <div class="settings-robots-hint"><strong>No Index</strong> — <span data-i18n="settings.advanced.seo_hint_noindex">Search engines won't list your CV (stays private in search)</span></div>
                        <div class="settings-robots-hint"><strong>Follow</strong> — <span data-i18n="settings.advanced.seo_hint_follow">Search engines will follow links on your CV (e.g. LinkedIn, GitHub)</span></div>
                        <div class="settings-robots-hint"><strong>No Follow</strong> — <span data-i18n="settings.advanced.seo_hint_nofollow">Search engines won't follow outbound links</span></div>
                    </div>
                    
                    <!-- Versioned URLs Indexing -->
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <div class="settings-option-title" data-i18n="settings.advanced.index_versioned">Index Versioned URLs</div>
                            <div class="settings-option-desc" data-i18n="settings.advanced.index_versioned_desc">Allow search engines to index public versioned CVs (/v/slug). When off, versioned pages get noindex.</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="settingSlugsIndex">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <!-- Tracking Code Setting -->
                    <div class="settings-field">
                        <label class="settings-field-label">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
                            <span data-i18n="settings.advanced.tracking_code">Tracking Code</span>
                        </label>
                        <div class="settings-field-desc" data-i18n="settings.advanced.tracking_code_desc">
                            Paste your analytics tracking code here (Google Analytics, Matomo, etc.). This code will be injected into the public CV pages.
                        </div>
                        <textarea 
                            id="settingTrackingCode" 
                            class="tracking-code-input" 
                            placeholder="<!-- Paste your tracking code here -->&#10;&lt;script&gt;&#10;  // Example: Google Analytics&#10;&lt;/script&gt;"
                            spellcheck="false"
                        ></textarea>
                        <div class="settings-field-hint">
                            <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            Code is inserted before the closing &lt;/head&gt; tag. Changes are saved when you click "Save Changes".
                        </div>
                    </div>
                </div>

                <!-- Language Tab -->
                <div class="settings-tab-content" id="settingsTabLanguage">
                    <div class="settings-info" data-i18n="settings.language.info">
                        Choose the display language for the CV Manager interface. This does not affect the content of your CV.
                    </div>
                    <div class="language-grid" id="languageGrid"></div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="modal-footer-left"></div>
                <div class="modal-footer-right">
                    <button class="btn btn-ghost" onclick="closeSettingsModal()" data-i18n="btn.cancel">Cancel</button>
                    <button class="btn btn-primary" onclick="saveSettingsSectionOrder()" data-i18n="btn.save_changes">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Section Modal -->
    <div class="modal-overlay" id="customSectionModalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="customSectionModalTitle" data-i18n="custom_section.add_title">Add Custom Section</h3>
                <button class="modal-close" onclick="closeCustomSectionModal()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="modal-body" id="customSectionModalBody"></div>
            <div class="modal-footer">
                <div class="modal-footer-left">
                    <button class="btn btn-danger" id="deleteCustomSectionBtn" onclick="deleteCustomSection()" style="display:none" data-i18n="btn.delete_section">Delete Section</button>
                </div>
                <div class="modal-footer-right">
                    <button class="btn btn-ghost" onclick="closeCustomSectionModal()" data-i18n="btn.cancel">Cancel</button>
                    <button class="btn btn-primary" onclick="saveCustomSection()" data-i18n="btn.save">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Section Item Modal -->
    <div class="modal-overlay" id="customItemModalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="customItemModalTitle" data-i18n="custom_item.add_title">Add Item</h3>
                <button class="modal-close" onclick="closeCustomItemModal()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="modal-body" id="customItemModalBody"></div>
            <div class="modal-footer">
                <div class="modal-footer-left">
                    <button class="btn btn-danger" id="deleteCustomItemBtn" onclick="deleteCustomItem()" style="display:none" data-i18n="btn.delete">Delete</button>
                </div>
                <div class="modal-footer-right">
                    <button class="btn btn-ghost" onclick="closeCustomItemModal()" data-i18n="btn.cancel">Cancel</button>
                    <button class="btn btn-primary" onclick="saveCustomItem()" data-i18n="btn.save">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script src="/shared/i18n.js"></script>
    <script src="/shared/scripts.js"></script>
    <script src="/shared/admin.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            await I18n.init();
            await initAdmin();
        });
    </script>
</body>
</html>
